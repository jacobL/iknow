<!DOCTYPE html>
<script src="http://smartdoe.cminl.oa/launchChrome.js?v=1811140812"></script>
<html lang="en">
<head>
<title>IKnow Admin</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<!--script src="../js/launchChrome_NEW.js"></script-->
<script src="../js/coq/3.1.1/jquery.js"></script>
<script src="../js/coq/bootstrap.bundle.min.js"></script>
 
 
<link rel="stylesheet" href="../css/coq/font-awesome.min.css">  

<script src="../js/coq/coqJS.js"></script>

<link href="../css/coq/bootstrap.min.css" rel="stylesheet"> 
<link rel="stylesheet" href="../css/coq/qaSTDUITemplate.css">
<style>
table, th, td {
  border: 1px solid black;
}
</style> 

<script>
var ajaxUrlPort = '127.0.0.1:81'; //桌機 
//var ajaxUrlPort = '10.55.52.98:31081'; //hpc

var currentPath = window.location.href;

var ssoUrl = "http://10.55.8.201:83/Publish/api/SSO";
$(document).ready(function() { 
	//setInterval("$('a[title=\"JavaScript charts\"]').hide();", 1000);
	//setInterval("saveLog();", 5000);
 	  
	var query = window.location.search.substring(1);
	var qs = parse_query_string(query);
	//SSO 取得User資料
	if (qs['userChineseName'] !== undefined){ 
		userChineseName = qs['userChineseName'];
		PERNR = qs['PERNR'];
		console.log(userChineseName+' '+PERNR)
		window.history.replaceState({}, document.title, window.location.pathname);
	}else{
		window.location.href = ssoUrl+"?redirectUrl="+currentPath;
		setTimeout(function(){console.log('SSO未取得工號');},30000);
	}
	
	if (qs['app'] !== undefined){
		app = qs['app'];
		if(app == 'AIIBU') app = 'AII BU';
		if(app == 'MDBU') app = 'MD BU';
		$('#app').html(app);
		window.history.replaceState({}, document.title, "/coq/bu.htm");
	}else{
		app = $("#app").html();
	}	
	setTimeout(function(){		 
		search();
	},100); 	 
});
var dataProvider;

function changeItem(id,text){
	if(id == 'ym_end'){
		text = '結束 '+text
	}	
	$('#'+id).html(text) 
	search();
}
 
function search(){ 
	db = 'mq'
	$.ajax({
		url: "http://"+ajaxUrlPort+"/getStandandQuestion",
		type: "GET",
		dataType: 'json',
		data:{db:db},
		contentType: "application/json; charset=utf-8",
		success: function (data) {
			//console.log(data);
			var tbody = '';
			for(var Answer_NO in data){
				//Answer_NO,System,Question,category_main,category_sub,Answer,Keyword,SOP_chapter,SOP_No,URL,Enabled,Creator,Create_Date
				//console.log('Answer_NO:'+Answer_NO+' '+data[Answer_NO]['System'])
				
				
				tbody = tbody+'<tr class="row100" style="cursor: pointer;" >';				 
				tbody = tbody+'<td class="" style="max-width:10px;min-width:80px;">'+Answer_NO+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:60px;">'+data[Answer_NO]['System']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:200px;">'+data[Answer_NO]['Question']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:140px;">'+data[Answer_NO]['category_main']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:150px;">'+data[Answer_NO]['category_sub']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:300px;">'+data[Answer_NO]['Answer']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:200px;">'+data[Answer_NO]['Keyword']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:120px;">'+data[Answer_NO]['SOP_chapter']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:80px;">'+data[Answer_NO]['SOP_No']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:200px;">'+data[Answer_NO]['URL']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:50px;">'+data[Answer_NO]['Enabled']+'</td>';
				tbody = tbody+'<td class="" style="max-width:10px;min-width:60px;">'+data[Answer_NO]['Creator']+'</td>';				
				tbody = tbody+'<td class="" style="max-width:10px;min-width:150px;">'+data[Answer_NO]['Create_Date']+'</td>';
				tbody = tbody+'</tr>';
				 
			}
			$('#tbody').html(tbody);
		},				
		error: function(xhr) {
		  alert('Ajax request 發生錯誤:'+JSON.stringify(xhr)); 
		}
	});	
}
 
</script>
</head>

  <body>
     <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" style="padding: .0rem 1rem;">
      <div class="container">
        <a class="navbar-brand" href="#"><font color="#FFD700">IKnow Admin</font></a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive" >
          <ul class="navbar-nav ">
            
			            
          </ul>
        </div>
      </div>
    </nav>
 
    <div class="card mb-4" style="height:100%;margin-top:40px;margin-left:10px; border: 0px;font-size:12px; width:1250px; overflow-y:scroll;overflow-x:scroll;">
		<table class=" table-bordered scrolltable table-hover" style="border-collapse: collapse; font-family:Microsoft JhengHei;"> 
			<thead style="display:block;overflow-y: scroll;border-bottom:1px solid #eee;"> 
				<tr id="table_head" style="" bgcolor="#FF8C00">
			
				  <th scope="col" style="width:80px;">Answer_NO</th>
				  <th scope="col" style="width:60px;">System</th>
				  <th scope="col" style="width:200px;">Question</th>
				  <th scope="col" style="width:140px;">category main</th>
				  <th scope="col" style="width:150px;">category sub</th>
				  <th scope="col" style="width:300px;">Answer</th>
				  <th scope="col" style="width:200px;">Keyword</th>
				  <th scope="col" style="width:120px;">SOP chapter</th>
				  <th scope="col" style="width:80px;">SOP No</th>
				  <th scope="col" style="width:200px;">URL</th>
				  <th scope="col" style="width:50px;">Enabled</th>
				  <th scope="col" style="width:60px;">Creator</th>
				  <th scope="col" style="width:150px;">Create Date</th>
				</tr>
			</thead>
			<tbody id="tbody" style="display:block;height:480px;overflow-y:scroll;overflow-x:scroll;">				
			</tbody>
		</table>			
	</div>
	
	<script> 
  
	 
	</script> 	
  </body>

</html>


